# v0.5.2 - Personalizaci√≥n de Blogs

**Fecha de lanzamiento**: Enero 2026
**URL de producci√≥n**: https://www.diariodeuninstante.com

---

## üéØ Resumen Ejecutivo

v0.5.2 a√±ade **personalizaci√≥n de blogs** para que cada usuario tenga su propio espacio diferenciado con dise√±o personalizado.

**Caracter√≠sticas clave**:
- ‚úÖ P√°ginas de perfil personal: `/@username`
- ‚úÖ Configuraci√≥n del blog (nombre, bio, fotos, colores)
- ‚úÖ Subida de im√°genes de perfil y cabecera
- ‚úÖ Dise√±o personalizado con colores a elecci√≥n
- ‚úÖ Enlace "Mi Blog" en navbar p√∫blico

---

## ‚úÖ Features Implementadas

### 1. Configuraci√≥n del Blog

**Ruta**: `/admin/configuracion-blog`

**Campos editables**:
- **Nombre**: Para "Diario de un Instante de [Nombre]"
- **Bio / Descripci√≥n**: Qui√©n eres y qu√© escribes
- **Foto de perfil**: Avatar circular (m√°x 2MB)
- **Foto de cabecera**: Banner superior (m√°x 5MB)
- **Color principal**: Para botones, enlaces y acentos
- **Color secundario**: Para fondos y fondos de tarjeta

**Funcionalidades**:
- Subida de im√°genes con validaci√≥n
- Vista previa en tiempo real
- Previsualizaci√≥n del t√≠tulo con colores aplicados
- Link para ver el blog personalizado

---

### 2. P√°ginas de Perfil de Usuario

**Ruta**: `/@[username]`

**Caracter√≠sticas**:
- **Cabecera personalizada**:
  - Foto de cabecera o color s√≥lido
  - Foto de perfil (avatar o iniciales)
  - T√≠tulo: "Diario de un Instante de [Nombre]"
  - Bio del usuario

- **Lista de instantes p√∫blicos**:
  - Solo muestra instantes con `privado: false` y `estado: 'publicado'`
  - Dise√±o personalizado con colores del usuario
  - Tarjetas con fondo y acentos personalizados

- **SEO optimizado**:
  - Meta tags din√°micos
  - T√≠tulo personalizado por usuario
  - Descripci√≥n basada en bio del usuario

- **P√°gina 404**:
  - Mensaje amigable cuando usuario no existe
  - Link para volver a la home

---

### 3. Firebase Storage

**Configuraci√≥n**:
- Export de `storage` desde `lib/firebase.ts`
- Helper functions en `lib/storage.ts`:
  - `uploadImage()`: Subida gen√©rica de im√°genes
  - `uploadAvatar()`: Subida de foto de perfil
  - `uploadHeaderPhoto()`: Subida de foto de cabecera

**Validaciones**:
- Tipo de archivo: Solo im√°genes (`image/*`)
- Tama√±o m√°ximo:
  - Avatar: 2MB
  - Cabecera: 5MB
- Nombres √∫nicos con timestamp

---

### 4. Enlace "Mi Blog" en Navbar

**Header p√∫blico**:
- Convertido a componente cliente (`'use client'`)
- Muestra enlace "Mi Blog" solo cuando usuario est√° autenticado
- Link apunta a `/@[username]` del usuario actual
- Estilo destacado en violeta

---

## üìÅ Archivos Modificados

### Core

**lib/firebase.ts**:
- A√±adido import de `getStorage`
- Export de `storage` para uso en la app

**lib/firestore.ts**:
- Nueva interfaz `BlogConfig`:
  - `displayName`: string
  - `bio?`: string
  - `photoURL?`: string
  - `headerPhotoURL?`: string
  - `primaryColor?`: string
  - `secondaryColor?`: string
- Nuevas funciones:
  - `getBlogConfig(userId)`: Obtener configuraci√≥n del blog
  - `updateBlogConfig(userId, config)`: Actualizar configuraci√≥n
  - `getUserByUsername(username)`: Buscar usuario por displayName

**lib/storage.ts** (NUEVO ARCHIVO):
- `uploadImage(file, path)`: Subida gen√©rica
- `uploadAvatar(userId, file)`: Subida de foto de perfil
- `uploadHeaderPhoto(userId, file)`: Subida de cabecera

### Componentes

**components/Header.tsx**:
- Convertido a cliente (`'use client'`)
- A√±adido `useAuth()` hook
- Link condicional "Mi Blog" para usuarios autenticados

**components/InstanteCard.tsx**:
- Nuevos props: `primaryColor`, `secondaryColor`, `showUser`
- Dise√±o con fondo personalizado
- Badge de tipo con color personalizado
- T√≠tulo con color personalizado

### P√°ginas

**app/admin/(dashboard)/configuracion-blog/page.tsx** (NUEVA):
- Formulario completo de configuraci√≥n
- Subida de im√°genes con preview
- Selector de colores
- Vista previa en tiempo real
- Link al blog personalizado

**app/@[username]/page.tsx** (NUEVA):
- P√°gina de perfil del usuario
- Cabecera personalizada
- Lista de instantes p√∫blicos
- 404 personalizado

**app/@[username]/not-found.tsx** (NUEVA):
- P√°gina 404 para usuario no encontrado

**app/admin/(dashboard)/layout.tsx**:
- A√±adido enlace "Mi Blog" en men√∫ desktop y m√≥vil

---

## üé® Caracter√≠sticas de UX/UI

### Responsive Design
- ‚úÖ Funciona en m√≥vil (320px+)
- ‚úÖ Funciona en escritorio (1920px+)
- ‚úÖ Im√°genes optimizadas por tama√±o de pantalla
- ‚úÖ Dark mode compatible

### Colores Personalizados
- **Color principal**: Aplicado a:
  - T√≠tulos
  - Badges (acci√≥n/pensamiento)
  - Botones
  - Enlaces destacados

- **Color secundario**: Aplicado a:
  - Fondos de tarjeta
  - Secciones de resalte
  - Fondos de cabecera (si no hay foto)

### Validaciones
- Im√°genes: M√°ximo 2MB (avatar) y 5MB (cabecera)
- Tipos: Solo `image/*`
- Nombre: Campo obligatorio
- Bio: M√°ximo 200 caracteres

---

## üîß Stack Tecnol√≥gico

### Firebase
- **Firebase Storage**: Almacenamiento de im√°genes
- **Firebase Firestore**: Configuraci√≥n del blog
- **Firebase Auth**: Usuario autenticado

### Next.js 14
- **App Router**: Rutas din√°micas `@[username]`
- **Server Components**: Metadata din√°mica
- **Client Components**: Formularios y uploads

### React
- **useState**: Estados de formularios
- **useEffect**: Carga de configuraci√≥n
- **useAuth**: Contexto de autenticaci√≥n

---

## üìä Configuraci√≥n Firebase Console

### Storage Rules

Las reglas de Storage deben permitir:
1. Lectura p√∫blica de avatares y cabeceras
2. Escritura solo para propietario autenticado

**Reglas recomendadas**:
```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /avatars/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    match /headers/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}
```

---

## ‚ö†Ô∏è Errores Conocidos y Soluciones

### "Storage bucket not configured"
**Causa**: Firebase Storage no est√° habilitado
**Soluci√≥n**:
1. Ve a Firebase Console > Storage
2. Haz clic en "Get started"
3. Selecciona ubicaci√≥n (ej: europe-west1)
4. Regla de seguridad: modo prueba (test mode)
5. Finaliza configuraci√≥n

### "Upload failed: Permission denied"
**Causa**: Reglas de Storage no permiten escritura
**Soluci√≥n**: Actualiza reglas de Storage para permitir escritura a usuarios autenticados

### "Imagen no se muestra"
**Causa**: URL de Storage no es p√∫blica
**Soluci√≥n**: Las URLs de `getDownloadURL()` son p√∫blicas por defecto, verifica que Storage est√© configurado correctamente

---

## üß™ Testing Manual

### Test 1: Configurar blog
1. Ve a `/admin/configuracion-blog`
2. Sube foto de perfil (jpg, <2MB)
3. Sube foto de cabecera (jpg, <5MB)
4. Cambia nombre a "Prueba"
5. A√±ade bio "Este es mi blog de prueba"
6. Cambia colores (ej: #ff0000, #ffe6e6)
7. Click en "Guardar configuraci√≥n"
8. **Verificar**: Mensaje "Configuraci√≥n guardada correctamente"

### Test 2: Ver perfil personalizado
1. Click en "Ver mi blog" o ve a `/@prueba`
2. **Verificar**:
   - T√≠tulo: "Diario de un Instante de Prueba"
   - Foto de perfil visible
   - Foto de cabecera visible
   - Bio visible
   - Colores aplicados

### Test 3: Instantes p√∫blicos en perfil
1. Aseg√∫rate de tener instantes p√∫blicos (`privado: false`, `estado: 'publicado'`)
2. Ve a tu perfil `/@[username]`
3. **Verificar**: Instantes p√∫blicos se muestran con colores personalizados

### Test 4: Enlace en navbar
1. Inicia sesi√≥n
2. **Verificar**: En navbar aparece "Mi Blog"
3. Click en "Mi Blog"
4. **Verificar**: Redirige a tu perfil `/@[username]`

### Test 5: Usuario no encontrado
1. Ve a `/@usuarioquenoxiste`
2. **Verificar**: P√°gina 404 personalizada con mensaje amigable

---

## üìà Mejoras UX

### Pre-v0.5.2
- Todos los blogs se ve√≠an igual
- Sin personalizaci√≥n
- Sin p√°ginas de perfil individual
- Sin im√°genes de usuario

### Post-v0.5.2
- Cada usuario tiene su blog personalizado
- Dise√±o √∫nico con fotos y colores
- SEO mejorado con metadata personalizada
- Identidad visual propia

---

## üîÑ Migraci√≥n desde v0.5.1

### Para Usuarios Existentes
- **Sin acci√≥n requerida**: Blogs funcionan con configuraci√≥n por defecto
- **Configuraci√≥n opcional**: Pueden personalizar su blog cuando quieran
- **DisplayName**: Usa el que ya ten√≠an en Firestore

### Para Nuevos Usuarios
- **Configuraci√≥n sugerida**: Se recomienda configurar su blog antes de publicar
- **Valores por defecto**:
  - Nombre: Email sin dominio o "Usuario"
  - Colores: Violeta por defecto (#8b5cf6, #f5f3ff)

---

## üöÄ Pr√≥ximos Pasos (v0.6)

**v0.6 - Social y Compartir**:
- OG Images autom√°ticas para compartir instantes
- RSS feeds globales y por usuario
- Comentarios en instantes p√∫blicos
- Reacciones (likes)
- Newsletter semanal

---

## üìä M√©tricas de √âxito

### Objetivo
- **Adopci√≥n**: >70% usuarios configuran su blog
- **Engagement**: +40% p√°ginas vistas por usuario
- **Retenci√≥n**: Usuarios con blog personalizado vuelven 2x m√°s

### Tracking
- Monitorizar cu√°ntos usuarios configuran su blog
- Medir tr√°fico a p√°ginas de perfil
- Trackear si los usuarios con blog personalizado escriben m√°s

---

## üéØ Conclusi√≥n

v0.5.2 hace que **Diario de un Instante sea m√°s personal y diferenciado**.

Los usuarios ahora tienen su propio espacio con identidad visual √∫nica, lo que aumenta el sentido de pertenencia y la motivaci√≥n para seguir escribiendo.

---

**Versi√≥n**: 0.5.2
**Estado**: ‚úÖ Production Ready
**Fecha**: Enero 2026
**Autor**: Javier Ben√≠tez + Claude Sonnet 4.5
**Deploy**: a504829
